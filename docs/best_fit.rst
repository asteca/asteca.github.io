.. _best-fit:

Fundamental parameters
----------------------

The best fit process aims at estimating the distributions for a set of the
cluster's fundamental parameters. The process basically consists in comparing
the observed cluster's photometric diagram with the diagrams of many synthetic
clusters generated with known parameters' values.


The process by which synthetic star clusters (SSC) are generated by **ASteCA**
involves several steps, described in the sections that follow.

The result of these steps is a SSC with given metallicity, age, extinction,
distance, mass and binarity values, affected by a maximum magnitude cut,
completeness star removal and photometric errors mimicking those of the
input observed cluster.



IMF sampling
------------

The initial mass function (IMF) is the distribution of initial masses
for a population of stars. For a population of :math:`N` stars with
masses :math:`m_i` and a total mass of :math:`M_T`:

.. math::
 IMF \, &\rightarrow \, \xi(m)=\frac{dn}{dm} \, \rightarrow \,dn = \xi(m)dm \\
 M_T &= \sum_{i=1}^N m_i \, \rightarrow \, M_T = C\int_{m_l}^{m_h} m(n)dn = \\
 &= C\int_{m_l}^{m_h} m\xi(m)dm

where :math:`m_l` and :math:`m_h` are the mass limits for the IMF
(:math:`m_h` is fixed to :math:`100 M_{\odot}` in the code) and
:math:`C` is a normalization constant. Setting the total mass to unity,
:math:`M_T=1 M_{\odot}`, allows us to obtain the normalization constant
:math:`C_1` and treat the normalized IMF as a PDF:

.. math::
 M_T=1M_{\odot}\, \rightarrow \, C_1 = \frac{1}{\int_{m_l}^{m_h} m\xi(m)dm}

and thus the normalized IMF can be written as:

.. math::
 PDF(m) = \xi(m)_{norm} = C_1 \xi(m)

This is the first step, performed by the ``get-IMF-PDF`` function for
a given selected IMF (Chabrier 2001, Kroupa et al. 1993, Kroupa 2002)

Once the PDF is generated, every time a new synthetic cluster is created
the ``get-mass-dist`` function is called from within ``synth-cluster``.
This former function takes the PDF and samples a number of masses
randomly from it, following the probabilities distribution given by the
PDF, until the mass fixed by the ``total-mass`` parameter is achieved.

The ``get-mass-dist`` function thus returns a distribution of masses
probabilistically sampled from a certain IMF, whose masses sum up to a
total cluster mass.

